{"version":3,"sources":["turbopack:///[project]/node_modules/next/src/server/route-modules/app-page/vendored/ssr/react.ts","turbopack:///[project]/node_modules/next/src/server/route-modules/app-page/vendored/contexts/app-router-context.ts","turbopack:///[project]/node_modules/next/src/server/route-modules/app-page/vendored/contexts/hooks-client-context.ts","turbopack:///[project]/node_modules/next/src/server/route-modules/app-page/vendored/contexts/server-inserted-html.ts","turbopack:///[project]/node_modules/next/src/server/route-modules/app-page/module.compiled.js","turbopack:///[project]/node_modules/next/src/server/route-modules/app-page/vendored/ssr/react-jsx-runtime.ts","turbopack:///[project]/node_modules/next/src/server/route-modules/app-page/vendored/ssr/react-server-dom-turbopack-client.ts","turbopack:///[project]/app/account/page.tsx"],"sourcesContent":["module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.React\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['contexts'].AppRouterContext\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['contexts'].HooksClientContext\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['contexts'].ServerInsertedHtml\n","if (process.env.NEXT_RUNTIME === 'edge') {\n  module.exports = require('next/dist/server/route-modules/app-page/module.js')\n} else {\n  if (process.env.__NEXT_EXPERIMENTAL_REACT) {\n    if (process.env.NODE_ENV === 'development') {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.dev.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.dev.js')\n      }\n    } else {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.prod.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.prod.js')\n      }\n    }\n  } else {\n    if (process.env.NODE_ENV === 'development') {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.dev.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page.runtime.dev.js')\n      }\n    } else {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.prod.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page.runtime.prod.js')\n      }\n    }\n  }\n}\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.ReactJsxRuntime\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.ReactServerDOMTurbopackClient\n","\"use client\";\r\n\r\nimport { useEffect, useState } from \"react\";\r\nimport Nav from \"@/components/Nav\"; // adjust path\r\nimport { useRouter } from \"next/navigation\";\r\n\r\ntype Sub = {\r\n  status?: string | null;\r\n  current_period_end?: number | string | null;\r\n  trial_end?: number | string | null;\r\n  plan_name?: string | null;\r\n};\r\n\r\nexport default function AccountPage() {\r\n  const router = useRouter();\r\n  const [loading, setLoading] = useState(true);\r\n  const [subLoading, setSubLoading] = useState(false);\r\n  const [data, setData] = useState<any>(null);\r\n  const [err, setErr] = useState<string | null>(null);\r\n\r\n  useEffect(() => {\r\n    (async () => {\r\n      try {\r\n        const res = await fetch(\"/api/check-usage\");\r\n        if (!res.ok) throw new Error(\"Failed\");\r\n        const json = await res.json();\r\n        setData(json);\r\n      } catch (e: any) {\r\n        setErr(\"Failed to load account data.\");\r\n        console.error(e);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    })();\r\n  }, []);\r\n\r\n  function formatDate(val?: number | string | null) {\r\n    if (!val) return \"—\";\r\n    const d = typeof val === \"number\" ? new Date(val * 1000) : new Date(val);\r\n    return d.toLocaleDateString();\r\n  }\r\n\r\n  async function openPortal() {\r\n    setSubLoading(true);\r\n\r\n    \r\n    await new Promise((resolve) => requestAnimationFrame(() => resolve(null)));\r\n\r\n    try {\r\n      const res = await fetch(\"/api/create-portal-session\", { method: \"POST\" });\r\n      const json = await res.json();\r\n      if (json?.url) {\r\n        window.location.href = json.url;\r\n      } else {\r\n        setErr(\"Could not open billing portal.\");\r\n      }\r\n    } catch (e) {\r\n      console.error(e);\r\n      setErr(\"Could not open billing portal.\");\r\n    } finally {\r\n      setSubLoading(false);\r\n    }\r\n  }\r\n\r\n  const sub: Sub | null = data?.subscription ?? null;\r\n  const username = data?.username ?? \"User\";\r\n  const isSubscribed = data?.isSubscribed ?? false;\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900\">\r\n      <Nav />\r\n\r\n      \r\n      <main className=\"max-w-3xl mx-auto px-6 lg:pl-28 lg:pr-8 p-6 pt-20 sm:pt-24\">\r\n        <h1 className=\"text-3xl font-bold text-purple-100 mb-2\">Account & Billing</h1>\r\n        <p className=\"text-purple-200 mb-6\">Manage your subscription, payment methods and invoices.</p>\r\n\r\n        {err && (\r\n          <div className=\"mb-4 p-3 rounded-lg bg-red-50 text-red-800 border border-red-200\">\r\n            {err}\r\n          </div>\r\n        )}\r\n\r\n        <div className=\"bg-gray-800/40 border border-purple-700/30 rounded-2xl p-6 mb-6\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <div>\r\n              <div className=\"text-sm text-purple-200\">User</div>\r\n              <div className=\"text-lg font-semibold text-purple-100\">{username}</div>\r\n            </div>\r\n\r\n            <div className=\"text-right\">\r\n              <div className=\"text-sm text-purple-200\">Status</div>\r\n              <div className=\"text-lg font-semibold text-purple-100\">\r\n                {sub ? (sub.status ?? \"Unknown\") : isSubscribed ? \"Active\" : \"Not subscribed\"}\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"grid grid-cols-1 sm:grid-cols-3 gap-4 mt-6\">\r\n            <div>\r\n              <div className=\"text-xs text-purple-200\">Plan</div>\r\n              <div className=\"text-sm text-purple-100\">{sub?.plan_name ?? (isSubscribed ? \"PRO\" : \"Free\")}</div>\r\n            </div>\r\n            <div>\r\n              <div className=\"text-xs text-purple-200\">Next billing</div>\r\n              <div className=\"text-sm text-purple-100\">{formatDate(sub?.current_period_end)}</div>\r\n            </div>\r\n            <div>\r\n              <div className=\"text-xs text-purple-200\">Trial ends</div>\r\n              <div className=\"text-sm text-purple-100\">{formatDate(sub?.trial_end)}</div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"mt-6 flex gap-3\">\r\n            <button\r\n              onClick={openPortal}\r\n              disabled={subLoading}\r\n              className=\"px-4 py-2 cursor-pointer rounded-xl bg-gradient-to-r from-sky-500 to-indigo-500 text-white font-semibold hover:brightness-105 disabled:opacity-50\"\r\n            >\r\n              {subLoading ? \"Opening portal…\" : \"Manage subscription\"}\r\n            </button>\r\n\r\n            <button\r\n              onClick={() => router.push(\"/subscribe\")}\r\n              className=\"px-4 py-2 cursor-pointer rounded-xl border border-purple-600 text-purple-100 hover:bg-purple-700/20\"\r\n            >\r\n              View plans\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n\r\n        <div className=\"bg-gray-800/30 border border-purple-700/20 rounded-2xl p-6\">\r\n          <h3 className=\"text-lg font-semibold text-purple-100 mb-3\">Invoices & Payments</h3>\r\n          <p className=\"text-sm text-purple-200\">You can view your invoices and payment history in the Stripe Customer Portal.</p>\r\n        </div>\r\n      </main>\r\n\r\n\r\n      {loading && (\r\n        <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/40 backdrop-blur-sm pointer-events-none\">\r\n          <div className=\"pointer-events-auto bg-white/6 rounded-lg p-6 flex items-center gap-4\">\r\n            <div className=\"flex items-center space-x-2\">\r\n              <div className=\"w-3 h-3 bg-blue-400 rounded-full animate-bounce\" />\r\n              <div className=\"w-3 h-3 bg-blue-400 rounded-full animate-bounce\" style={{ animationDelay: \"0.15s\" }} />\r\n              <div className=\"w-3 h-3 bg-blue-400 rounded-full animate-bounce\" style={{ animationDelay: \"0.3s\" }} />\r\n            </div>\r\n            <div className=\"text-white\">Loading account…</div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      \r\n      {subLoading && (\r\n        <div className=\"fixed inset-0 z-60 flex items-center justify-center bg-black/60\">\r\n          <div className=\"flex flex-col items-center\">\r\n            <div className=\"w-12 h-12 border-4 border-gray-300 border-t-blue-400 rounded-full animate-spin mb-4\" />\r\n            <div className=\"text-white\">Opening billing portal…</div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"names":["module","exports","require","vendored","React","AppRouterContext","HooksClientContext","ServerInsertedHtml","process","env","NEXT_RUNTIME","__NEXT_EXPERIMENTAL_REACT","NODE_ENV","TURBOPACK","ReactJsxRuntime","ReactServerDOMTurbopackClient"],"mappings":"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","ignoreList":[0,1,2,3,4,5,6]}