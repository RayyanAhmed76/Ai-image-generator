module.exports=[72131,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].React},9270,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.AppRouterContext},36313,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.HooksClientContext},18341,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.ServerInsertedHtml},18622,(a,b,c)=>{b.exports=a.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},20635,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},42602,(a,b,c)=>{"use strict";b.exports=a.r(18622)},87924,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactJsxRuntime},38783,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactServerDOMTurbopackClient},60350,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(7998);function f(){let a=(0,d.useRouter)(),[f,g]=(0,c.useState)(null),[h,i]=(0,c.useState)(null),[j,k]=(0,c.useState)(""),[l,m]=(0,c.useState)(!1),[n,o]=(0,c.useState)(null),[p,q]=(0,c.useState)(!1),[r,s]=(0,c.useState)(50),[t,u]=(0,c.useState)(!1),v=(0,c.useRef)(null),w=(0,c.useRef)(null);(0,c.useEffect)(()=>{(async()=>{try{let b=await fetch("/api/check-usage"),c=await b.json();c.limitReached&&!c.isSubscribed&&a.replace("/subscribe")}catch(a){console.error("Error checking usage:",a)}})()},[a]),(0,c.useEffect)(()=>()=>{w.current&&(clearInterval(w.current),w.current=null)},[]);let[x,y]=(0,c.useState)(null),z=(0,c.useRef)(null);(0,c.useEffect)(()=>{let a=a=>{let b=a?.detail;A(b?.message??"Notification")};return window.addEventListener("app:notify",a),()=>window.removeEventListener("app:notify",a)},[]);let A=(a,b=3e3)=>{y(a),z.current&&window.clearTimeout(z.current),z.current=window.setTimeout(()=>y(null),b)};(0,c.useEffect)(()=>{if(!n)return;let a=v.current;if(!a)return;a.innerHTML="";let b=["#60A5FA","#F97316","#34D399","#F472B6","#F59E0B","#A78BFA"];for(let c=0;c<14;c++){let c=document.createElement("span");c.className="confetti-piece absolute rounded-sm",c.style.left=`${20+60*Math.random()}%`,c.style.top=`${10+30*Math.random()}%`,c.style.width=`${6+8*Math.random()}px`,c.style.height=`${10+10*Math.random()}px`,c.style.background=b[Math.floor(Math.random()*b.length)],c.style.transform=`translateY(-10px) rotate(${360*Math.random()}deg)`,c.style.opacity="0",c.style.animation=`confetti ${900+400*Math.random()}ms cubic-bezier(.2,.8,.2,1) forwards ${200*Math.random()}ms`,a.appendChild(c)}let c=setTimeout(()=>a.innerHTML="",1600);return()=>clearTimeout(c)},[n]);let B=a=>{if(!a)return;let b=new FileReader;b.onloadend=()=>{let a=b.result;if(!a)return void A("Failed to read file");g(a);let c=a.indexOf(",");i(c>=0?a.slice(c+1):a),A("Image ready -> now enter a prompt")},b.readAsDataURL(a)},C=async()=>{if(!h)return A("Upload an image first");if(!j.trim())return A("Enter a prompt");q(!0),m(!0);try{let a=await fetch("/api/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:j,base64Image:h})}),b=await a.json();if(403===a.status&&b?.limitReached){A("Free trial limit reached. Redirecting to subscription..."),setTimeout(()=>{window.location.href="/subscribe"},2e3);return}if(401===a.status){A("Please log in to continue"),setTimeout(()=>{window.location.href="/login"},2e3);return}if(b?.image){o(b.image),q(!1),A("Generated!");return}if(b?.polling_url){A("Submitted —> now processing...");let a=b.polling_url,c=0;w.current&&clearInterval(w.current),w.current=setInterval(async()=>{c++;try{let b=await fetch("/api/fetch_result",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({pollingUrl:a})}),d=await b.json();d?.imageUrl?(w.current&&(clearInterval(w.current),w.current=null),o(d.imageUrl),q(!1),m(!1),A("Generated!")):c>=60&&(w.current&&(clearInterval(w.current),w.current=null),q(!1),m(!1),A("Generation timeout. Please try again."))}catch(a){console.error("Polling error:",a),c>=60&&(w.current&&(clearInterval(w.current),w.current=null),q(!1),m(!1),A("Error fetching result. Please try again."))}},5e3);return}b?.error&&(q(!1),A(b.error))}catch(a){q(!1),A("Network error")}finally{m(!1)}},D=async()=>{if(n)try{let a;if(n.startsWith("data:")){let b=await fetch(n);a=await b.blob()}else{A("Preparing download...");let b=await fetch("/api/fetch-image",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({imageUrl:n})}),c=await b.json();if(!b.ok||c.error)return void A(c.error||"Failed to prepare download");let d=await fetch(c.dataUrl);a=await d.blob()}let b=window.URL.createObjectURL(a),c=document.createElement("a");c.href=b,c.download=`generated-image-${Date.now()}.png`,document.body.appendChild(c),c.click(),document.body.removeChild(c),window.URL.revokeObjectURL(b),A("Image downloaded!")}catch(a){console.error("Error downloading image:",a),A("Failed to download image")}};(0,c.useEffect)(()=>{if(!t)return;let a=a=>{if(!f||!n)return;let b=document.querySelector("[data-slider-container]");if(!b)return;let c=b.getBoundingClientRect();s(Math.max(0,Math.min(100,(a.clientX-c.left)/c.width*100)))},b=()=>{u(!1)};return document.addEventListener("mousemove",a),document.addEventListener("mouseup",b),()=>{document.removeEventListener("mousemove",a),document.removeEventListener("mouseup",b)}},[t,f,n]);let E=async()=>{if(n)try{if(n.startsWith("data:")){let a=n.indexOf(","),b=a>=0?n.slice(a+1):n;g(n),i(b),A("Image loaded! Enter a new prompt to modify it.")}else{A("Loading image...");let a=await fetch("/api/fetch-image",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({imageUrl:n})}),b=await a.json();if(!a.ok||b.error)return void A(b.error||"Failed to load image");g(b.dataUrl),i(b.base64),A("Image loaded! Enter a new prompt to modify it.")}}catch(a){console.error("Error using generated image:",a),A("Failed to load image")}};return(0,b.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900",children:[(0,b.jsx)(e.default,{}),(0,b.jsxs)("div",{className:"max-w-6xl mx-auto px-6 lg:pl-28 lg:pr-8 p-4 sm:p-6 pt-20 sm:pt-24",children:[(0,b.jsx)("div",{ref:v,className:"pointer-events-none fixed inset-0 z-50"}),(0,b.jsx)("div",{"aria-live":"polite",className:"fixed inset-0 flex items-end px-4 py-6 pointer-events-none sm:items-start z-50",children:(0,b.jsx)("div",{className:"w-full flex flex-col items-center space-y-2 sm:items-end",children:x&&(0,b.jsx)("div",{className:"pointer-events-auto max-w-md w-full bg-gray-800/95 backdrop-blur-md text-gray-100 border border-gray-600/50 rounded-lg shadow-lg overflow-hidden",children:(0,b.jsx)("div",{className:"p-3 text-sm",children:x})})})}),(0,b.jsxs)("header",{className:"mb-6 sm:mb-8",children:[(0,b.jsx)("h1",{className:"text-3xl sm:text-4xl md:text-5xl font-extrabold bg-gradient-to-r from-purple-100 via-purple-200 to-indigo-200 bg-clip-text text-transparent pb-3 ",children:"Imagine your Bunyad"}),(0,b.jsxs)("p",{className:"text-purple-300 text-base sm:text-lg font-medium mt-2 flex items-center gap-2 flex-wrap",children:[(0,b.jsx)("span",{className:"text-purple-400",children:"Upload"}),(0,b.jsx)("span",{className:"text-purple-500",children:"→"}),(0,b.jsx)("span",{className:"text-purple-400",children:"Prompt"}),(0,b.jsx)("span",{className:"text-purple-500",children:"→"}),(0,b.jsx)("span",{className:"text-purple-400",children:"Generate"})]})]}),(0,b.jsxs)("main",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,b.jsxs)("section",{className:"lg:col-span-2 space-y-6",children:[(0,b.jsx)("div",{onDrop:a=>{a.preventDefault(),B(a.dataTransfer?.files?.[0]??null)},onDragOver:a=>a.preventDefault(),className:"rounded-2xl p-4 sm:p-6 border border-purple-700/30 bg-gray-800/40 backdrop-blur-sm shadow-lg",children:(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 sm:gap-6",children:[(0,b.jsx)("div",{className:"w-full sm:w-56 h-48 sm:h-56 bg-gray-700/60 hover:bg-gray-700/80 rounded-xl flex items-center justify-center cursor-pointer border border-gray-600/30",onClick:()=>{let a=document.createElement("input");a.type="file",a.accept="image/*",a.onchange=a=>B(a.target.files?.[0]??null),a.click()},children:f?(0,b.jsx)("img",{src:f,className:"w-full h-full object-cover rounded-xl"}):(0,b.jsxs)("div",{className:"text-center transition-transform duration-200 hover:scale-110",children:[(0,b.jsxs)("svg",{className:"w-12 h-12 text-gray-400 mx-auto mb-2",fill:"none",viewBox:"0 0 24 24",children:[(0,b.jsx)("path",{d:"M12 4v8",stroke:"currentColor",strokeWidth:"2"}),(0,b.jsx)("path",{d:"M20 12l-8-8-8 8",stroke:"currentColor",strokeWidth:"2"}),(0,b.jsx)("rect",{x:"3",y:"12",width:"18",height:"8",rx:"2",stroke:"currentColor",strokeWidth:"1.5"})]}),(0,b.jsx)("p",{className:"text-sm text-gray-300",children:"Upload Image"})]})}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("label",{className:"text-sm font-medium text-purple-200",children:"Prompt"}),(0,b.jsx)("textarea",{value:j,onChange:a=>k(a.target.value),className:"w-full mt-2 p-3 border border-gray-600/30 rounded-xl min-h-[140px] bg-gray-700/60 text-gray-100 placeholder-gray-400/50 focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"e.g. Change background to Tokyo at night"}),(0,b.jsxs)("div",{className:"flex gap-2 sm:gap-3 mt-3",children:[(0,b.jsx)("button",{onClick:C,disabled:l,className:"flex-1 sm:flex-none px-3 sm:px-4 py-2 bg-gradient-to-r from-sky-500 to-indigo-500 hover:from-sky-600 hover:to-indigo-600 text-white rounded-lg shadow-lg text-xs sm:text-sm cursor-pointer font-medium transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:l?"Working...":"Generate"}),(0,b.jsx)("button",{onClick:()=>{g(null),i(null),k(""),o(null)},className:"px-3 sm:px-4 py-2 border border-purple-700/50 rounded-lg hover:bg-purple-800/50 text-purple-200 text-xs sm:text-sm cursor-pointer transition-colors",children:"Clear"})]})]})]})}),(0,b.jsxs)("div",{className:"relative rounded-2xl bg-gray-800/40 backdrop-blur-sm border border-purple-700/30 p-4 sm:p-6 shadow-lg",children:[p&&(0,b.jsxs)("div",{className:"absolute inset-0 bg-purple-900/90 backdrop-blur-sm flex flex-col items-center justify-center rounded-2xl z-20",children:[(0,b.jsxs)("svg",{className:"w-12 h-12 text-purple-400 animate-spin mb-2",viewBox:"0 0 24 24",children:[(0,b.jsx)("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"3",className:"opacity-20"}),(0,b.jsx)("path",{d:"M22 12a10 10 0 0 0-10-10",stroke:"currentColor",strokeWidth:"3"})]}),(0,b.jsx)("p",{className:"animate-pulse text-purple-200",children:"Generating..."})]}),(0,b.jsx)("h3",{className:"font-semibold text-lg mb-4 text-purple-100",children:"Result"}),n?(0,b.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[f&&(0,b.jsxs)("div",{className:"w-full max-w-[520px] relative rounded-xl overflow-hidden border border-purple-700/50 bg-purple-900/50",children:[(0,b.jsxs)("div",{className:"relative w-full",style:{aspectRatio:"1/1",maxHeight:"520px"},"data-slider-container":!0,children:[(0,b.jsx)("img",{src:f,className:"absolute inset-0 w-full h-full object-contain",alt:"Original"}),(0,b.jsx)("div",{className:"absolute inset-0 overflow-hidden",style:{clipPath:`inset(0 ${100-(r||50)}% 0 0)`},children:(0,b.jsx)("img",{src:n,className:"w-full h-full object-contain",alt:"Generated"})}),(0,b.jsx)("div",{className:"absolute top-0 bottom-0 w-1 bg-white shadow-lg cursor-ew-resize z-10",style:{left:`${r||50}%`},onMouseDown:a=>{a.preventDefault(),u(!0)},onTouchStart:()=>u(!0),children:(0,b.jsx)("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-8 h-8 bg-white rounded-full shadow-lg flex items-center justify-center",children:(0,b.jsx)("svg",{className:"w-4 h-4 text-purple-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 9l4-4 4 4m0 6l-4 4-4-4"})})})})]}),(0,b.jsx)("div",{className:"absolute bottom-2 left-2 px-2 py-1 bg-purple-900/80 rounded text-xs text-purple-200",children:"After"}),(0,b.jsx)("div",{className:"absolute bottom-2 right-2 px-2 py-1 bg-purple-900/80 rounded text-xs text-purple-200",children:"Before"})]}),!f&&(0,b.jsx)("div",{className:"w-full max-w-[520px] bg-purple-900/50 rounded-xl overflow-hidden border border-purple-700/50 flex justify-center",children:(0,b.jsx)("img",{src:n,className:"w-full max-h-[520px] object-contain",alt:"Result"})}),(0,b.jsxs)("div",{className:"flex w-full max-w-[520px] gap-2 sm:gap-4 flex-wrap",children:[(0,b.jsx)("button",{onClick:()=>window.open(n,"_blank"),className:"flex-1 min-w-[80px] px-2 sm:px-3 py-2 cursor-pointer border border-purple-700/50 rounded-lg hover:bg-purple-800/50 text-purple-200 text-xs sm:text-sm transition-colors",children:"Open"}),(0,b.jsx)("button",{onClick:D,className:"flex-1 min-w-[80px] px-2 sm:px-3 py-2 cursor-pointer bg-gradient-to-r from-sky-500 to-indigo-500 text-white rounded-lg hover:from-sky-600 hover:to-indigo-600 text-xs sm:text-sm font-medium shadow-lg transition-all",children:"Download"}),(0,b.jsx)("button",{onClick:E,className:"flex-1 min-w-[120px] px-2 sm:px-3 py-2 cursor-pointer border border-purple-700/50 rounded-lg hover:bg-purple-800/50 text-purple-200 text-xs sm:text-sm transition-colors",children:"Use Image"})]})]}):(0,b.jsx)("p",{className:"text-purple-400",children:"No result yet"})]})]}),(0,b.jsxs)("aside",{className:"space-y-4 sm:space-y-6",children:[(0,b.jsxs)("div",{className:"rounded-2xl bg-gray-800/40 backdrop-blur-sm border border-purple-700/30 p-4 sm:p-5 shadow-lg",children:[(0,b.jsx)("h4",{className:"font-semibold mb-3 text-purple-100 text-sm sm:text-base",children:"Quick Tools"}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,b.jsx)("button",{onClick:()=>k("remove background"),className:"px-3 py-2 cursor-pointer rounded-lg bg-gradient-to-br from-sky-400 to-indigo-500 text-white font-medium shadow-sm transform transition hover:-translate-y-0.5 hover:shadow-lg",children:"Remove BG"}),(0,b.jsx)("button",{onClick:()=>k("enhance lighting and clarity"),className:"px-3 py-2 cursor-pointer rounded-lg bg-gradient-to-br from-sky-400 to-indigo-500 text-white font-medium shadow-sm transform transition hover:-translate-y-0.5 hover:shadow-lg",children:"Enhance"}),(0,b.jsx)("button",{onClick:()=>k("turn into painting"),className:"px-3 py-2 cursor-pointer rounded-lg bg-gradient-to-br from-sky-400 to-indigo-500 text-white font-medium shadow-sm transform transition hover:-translate-y-0.5 hover:shadow-lg",children:"Painting"}),(0,b.jsx)("button",{onClick:()=>k("remove watermark"),className:"px-3 py-2 cursor-pointer rounded-lg bg-gradient-to-br from-sky-400 to-indigo-500 text-white font-medium shadow-sm transform transition hover:-translate-y-0.5 hover:shadow-lg",children:"Remove Watermark"})]})]}),(0,b.jsx)("div",{className:"rounded-2xl bg-gray-800/40 backdrop-blur-sm border border-purple-700/30 p-4 sm:p-5 shadow-lg flex items-center justify-center h-[100px] sm:h-[120px]",children:(0,b.jsx)("p",{className:"text-xs sm:text-sm text-purple-400 text-center",children:" More tools coming soon..."})})]})]})]}),(0,b.jsx)("style",{children:`
        @keyframes confetti { 0% { transform: translateY(-10px) rotate(0deg); opacity: 1; } 100% { transform: translateY(220px) rotate(360deg); opacity: 0; } }
        .confetti-piece { will-change: transform, opacity; pointer-events:none; }
      `})]})}a.s(["default",()=>f])}];

//# sourceMappingURL=%5Broot-of-the-server%5D__3de282c6._.js.map