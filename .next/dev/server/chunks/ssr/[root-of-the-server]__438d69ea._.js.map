{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Administrator/my-flux-saas/components/Nav.tsx"],"sourcesContent":["\"use client\";\n\nimport Link from \"next/link\";\nimport { usePathname, useRouter } from \"next/navigation\";\nimport { ChevronDown, LogOut } from \"lucide-react\";\nimport { useState, useRef, useEffect } from \"react\";\n\nexport default function Nav() {\n  const router = useRouter();\n  const pathname = usePathname();\n\n  const [open, setOpen] = useState(false);\n  const dropdownRef = useRef<HTMLDivElement | null>(null);\n  const [username, setUsername] = useState<string>(\"User\");\n  const [userInitial, setUserInitial] = useState<string>(\"U\");\n\n  // Fetch user info on mount\n  useEffect(() => {\n    const fetchUserInfo = async () => {\n      try {\n        const res = await fetch(\"/api/check-usage\");\n        const data = await res.json();\n        \n        if (data.authenticated && data.username) {\n          setUsername(data.username);\n          setUserInitial(data.username.charAt(0).toUpperCase());\n        }\n      } catch (err) {\n        console.error(\"Error fetching user info:\", err);\n      }\n    };\n    \n    fetchUserInfo();\n  }, []);\n\n\n  useEffect(() => {\n    function handleDocumentClick(e: MouseEvent) {\n      if (!dropdownRef.current) return;\n      if (!dropdownRef.current.contains(e.target as Node)) {\n        setOpen(false);\n      }\n    }\n    document.addEventListener(\"click\", handleDocumentClick);\n    return () => document.removeEventListener(\"click\", handleDocumentClick);\n  }, []);\n\n  const handleLogout = async () => {\n    try {\n      await fetch(\"/api/logout\", { method: \"POST\" });\n      window.dispatchEvent(\n        new CustomEvent(\"app:notify\", { detail: { message: \"Logged out\" } })\n      );\n      // small delay so user can see toast if present\n      setTimeout(() => router.push(\"/login\"), 600);\n    } catch (err) {\n      window.dispatchEvent(\n        new CustomEvent(\"app:notify\", { detail: { message: \"Logout failed\" } })\n      );\n    }\n  };\n\n  return (\n    <>\n      {/* Left Sidebar */}\n      <nav className=\"fixed left-0 top-0 h-full w-16 sm:w-20 bg-gradient-to-b from-purple-900/90 via-purple-800/90 to-indigo-900/90 backdrop-blur-md border-r border-purple-700/50 z-40 flex flex-col items-center py-4 sm:py-6\">\n        {/* Logo at top of sidebar */}\n        <Link href=\"/\" className=\"mb-6 sm:mb-8\">\n          <div className=\"w-12 h-12 sm:w-16 sm:h-16 rounded-xl p-1.5 sm:p-2 flex items-center justify-center shadow-lg hover:shadow-xl transition-shadow\">\n            <img \n              src=\"/logo.png\" \n              alt=\"Logo\" \n              className=\"w-full h-full object-contain\"\n              onError={(e) => {\n                // Fallback if image doesn't exist\n                const target = e.target as HTMLImageElement;\n                target.style.display = 'none';\n                if (target.parentElement) {\n                  target.parentElement.innerHTML = '<div class=\"w-full h-full rounded-xl bg-gradient-to-br from-purple-500 via-purple-600 to-indigo-600 flex items-center justify-center text-white font-bold text-sm sm:text-xl\">AI</div>';\n                }\n              }}\n            />\n          </div>\n        </Link>\n\n        {/* Nav links */}\n        <div className=\"flex flex-col gap-4 sm:gap-6\">\n          <Link\n            href=\"/\"\n            className={`p-2 sm:p-3 rounded-lg transition-all ${\n              pathname === \"/\"\n                ? \"bg-purple-600/50 text-white shadow-lg\"\n                : \"text-purple-200 hover:bg-purple-700/30 hover:text-white\"\n            }`}\n            title=\"Studio\"\n          >\n            <svg className=\"w-5 h-5 sm:w-6 sm:h-6\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z\" />\n            </svg>\n          </Link>\n\n          <Link\n            href=\"/subscribe\"\n            className={`p-2 sm:p-3 rounded-lg transition-all ${\n              pathname === \"/subscribe\"\n                ? \"bg-purple-600/50 text-white shadow-lg\"\n                : \"text-purple-200 hover:bg-purple-700/30 hover:text-white\"\n            }`}\n            title=\"Plans\"\n          >\n            <svg className=\"w-5 h-5 sm:w-6 sm:h-6\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" />\n            </svg>\n          </Link>\n\n          <Link\n            href=\"/about\"\n            className={`p-2 sm:p-3 rounded-lg transition-all ${\n              pathname === \"/about\"\n                ? \"bg-purple-600/50 text-white shadow-lg\"\n                : \"text-purple-200 hover:bg-purple-700/30 hover:text-white\"\n            }`}\n            title=\"About\"\n          >\n            <svg className=\"w-5 h-5 sm:w-6 sm:h-6\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" />\n            </svg>\n          </Link>\n        </div>\n\n        {/* Logout button at bottom */}\n        <div className=\"mt-auto\">\n          <div ref={dropdownRef} className=\"relative\">\n            <button\n              onClick={() => setOpen((s) => !s)}\n              aria-haspopup=\"true\"\n              aria-expanded={open}\n              className=\"p-2 sm:p-3 rounded-lg text-purple-200 hover:bg-purple-700/30 hover:text-white transition-all cursor-pointer\"\n              title={username}\n            >\n              <div className=\"w-8 h-8 sm:w-10 sm:h-10 rounded-full bg-gradient-to-br from-purple-500 to-indigo-600 flex items-center justify-center font-semibold text-white text-xs sm:text-sm shadow-lg\">\n                {userInitial}\n              </div>\n            </button>\n\n            {open && (\n              <div className=\"absolute left-full ml-2 sm:ml-4 bottom-0 w-40 sm:w-48 bg-purple-800/95 backdrop-blur-md border border-purple-600/50 rounded-lg shadow-xl z-50\">\n                <div className=\"p-2 sm:p-3\">\n                  <div className=\"px-2 sm:px-3 py-1.5 sm:py-2 text-xs sm:text-sm text-purple-100 font-medium border-b border-purple-700/50\">\n                    {username}\n                  </div>\n                  <button\n                    onClick={handleLogout}\n                    className=\"w-full flex items-center gap-2 px-2 sm:px-3 py-1.5 sm:py-2 text-xs sm:text-sm text-purple-200 hover:bg-purple-700/50 rounded cursor-pointer transition-colors\"\n                    aria-label=\"Logout\"\n                  >\n                    <LogOut size={14} className=\"sm:w-4 sm:h-4\" />\n                    <span>Logout</span>\n                  </button>\n                </div>\n              </div>\n            )}\n          </div>\n        </div>\n      </nav>\n    </>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}