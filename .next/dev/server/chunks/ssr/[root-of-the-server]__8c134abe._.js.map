{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Administrator/Desktop/my-flux-saas/components/Nav.tsx"],"sourcesContent":["\"use client\";\n\nimport Link from \"next/link\";\nimport { usePathname, useRouter } from \"next/navigation\";\nimport { LogOut } from \"lucide-react\";\nimport { useState, useRef, useEffect } from \"react\";\n\ntype SubscriptionShape = {\n  status?: \"active\" | \"trialing\" | \"canceled\" | \"none\" | string;\n  current_period_end?: number | string | null; // unix seconds or ISO\n  trial_end?: number | string | null; // unix seconds or ISO\n};\n\nexport default function Nav() {\n  const router = useRouter();\n  const pathname = usePathname();\n\n  const [open, setOpen] = useState(false); // avatar dropdown\n  const [mobileOpen, setMobileOpen] = useState(false); // mobile sidebar state\n  const dropdownRef = useRef<HTMLDivElement | null>(null);\n  const [username, setUsername] = useState<string>(\"User\");\n  const [userInitial, setUserInitial] = useState<string>(\"U\");\n\n  // subscription state\n  const [subscription, setSubscription] = useState<SubscriptionShape | null>(null);\n  const [subLoading, setSubLoading] = useState<boolean>(true);\n\n  \n  const mobileNavWidthRem = 11; //used in css for rem\n\n  function toDate(value?: number | string | null): Date | null {\n    if (!value) return null;\n    if (typeof value === \"number\") {\n      return value > 1e12 ? new Date(value) : new Date(value * 1000);\n    }\n    // string: try ISO\n    const d = new Date(value);\n    return isNaN(d.getTime()) ? null : d;\n  }\n\n  function daysLeft(until?: number | string | null) {\n    const d = toDate(until);\n    if (!d) return null;\n    const now = new Date();\n    const ms = d.getTime() - now.getTime();\n    return Math.ceil(ms / (1000 * 60 * 60 * 24));\n  }\n\n  // Fetch user & subscription info on mount\n  useEffect(() => {\n    const fetchUserInfo = async () => {\n      try {\n        const res = await fetch(\"/api/check-usage\");\n        const data = await res.json();\n\n        if (data?.authenticated && data?.username) {\n          setUsername(data.username);\n          setUserInitial(data.username.charAt(0).toUpperCase());\n        }\n\n        // Try to read subscription info from this endpoint if provided\n        if (data?.subscription) {\n          setSubscription(data.subscription as SubscriptionShape);\n          setSubLoading(false);\n          return;\n        }\n\n        // fallback: hit a dedicated subscription endpoint\n        try {\n          const res2 = await fetch(\"/api/subscription-status\");\n          if (res2.ok) {\n            const sdata = await res2.json();\n            setSubscription(sdata || null);\n          } else {\n            setSubscription(null);\n          }\n        } catch (err) {\n          console.warn(\"subscription-status fetch failed\", err);\n          setSubscription(null);\n        }\n      } catch (err) {\n        console.error(\"Error fetching user info:\", err);\n        setSubscription(null);\n      } finally {\n        setSubLoading(false);\n      }\n    };\n\n    fetchUserInfo();\n  }, []);\n\n  // Close dropdown when clicking outside\n  useEffect(() => {\n    function handleDocumentClick(e: MouseEvent) {\n      if (!dropdownRef.current) return;\n      if (!dropdownRef.current.contains(e.target as Node)) {\n        setOpen(false);\n      }\n    }\n    document.addEventListener(\"click\", handleDocumentClick);\n    return () => document.removeEventListener(\"click\", handleDocumentClick);\n  }, []);\n\n  \n  useEffect(() => {\n    setMobileOpen(false);\n  }, [pathname]);\n\n  // Add/remove a class on body and inject CSS to center content while mobile nav is open\n  useEffect(() => {\n    const CLASS = \"mobile-nav-open\";\n    const STYLE_ID = \"mobile-nav-open-style\";\n\n    function addStyle() {\n      if (document.getElementById(STYLE_ID)) return;\n      const style = document.createElement(\"style\");\n      style.id = STYLE_ID;\n      style.innerHTML = `\n        /* Centers the main app content when mobile nav is open.\n           Adjust the selector (#__next > *) if your app structure differs. */\n        body.${CLASS} #__next > * {\n          margin-left: auto !important;\n          margin-right: auto !important;\n          max-width: calc(100% - ${mobileNavWidthRem}rem) !important; /* account for nav width + gap */\n        }\n\n        @media (max-width: 420px) {\n          body.${CLASS} #__next > * {\n            max-width: calc(100% - ${mobileNavWidthRem - 0.5}rem) !important;\n          }\n        }\n      `;\n      document.head.appendChild(style);\n    }\n\n    if (mobileOpen) {\n      document.body.classList.add(CLASS);\n      addStyle();\n    } else {\n      document.body.classList.remove(CLASS);\n    }\n\n    return () => {\n      document.body.classList.remove(CLASS);\n    };\n  }, [mobileOpen]);\n\n  const handleLogout = async () => {\n    try {\n      await fetch(\"/api/logout\", { method: \"POST\" });\n      window.dispatchEvent(\n        new CustomEvent(\"app:notify\", { detail: { message: \"Logged out\" } })\n      );\n      setTimeout(() => router.push(\"/login\"), 600);\n    } catch (err) {\n      window.dispatchEvent(\n        new CustomEvent(\"app:notify\", { detail: { message: \"Logout failed\" } })\n      );\n    }\n  };\n\n  // mobile closed transform: slide out to the right. On sm+ we always show (sm:translate-x-0)\n  const mobileClosedTransform = mobileOpen ? \"translate-x-0\" : \"translate-x-full\";\n\n  // border: default (mobile) use left border because nav sits on right; on sm+ (desktop) use right border (nav on left)\n  const borderResponsive = \"border-l border-purple-700/50 sm:border-r sm:border-l-0\";\n\n  // helpers for rendering subscription UI\n  const renderSubscriptionRow = () => {\n    if (subLoading) {\n      return (\n        <div className=\"text-center py-2 text-xs text-purple-200\">Loading subscription…</div>\n      );\n    }\n\n    const s = subscription || { status: \"none\" };\n\n    if (s.status === \"trialing\" || s.status === \"trial\") {\n      const days = daysLeft(s.trial_end);\n      return (\n        <div className=\"flex flex-col gap-2\">\n          <div className=\"text-sm font-medium text-purple-100\">Free trial</div>\n          <div className=\"text-xs text-purple-200\">\n            {days === null\n              ? \"Trial active\"\n              : days > 0\n              ? `${days} day${days > 1 ? \"s\" : \"\"} left`\n              : \"Trial ending soon\"}\n          </div>\n\n          <div className=\"pt-2\">\n            <button\n              onClick={() => router.push(\"/subscribe\")}\n              className=\"block w-full text-center px-2 py-1 rounded-md bg-gradient-to-r from-sky-500 to-indigo-500 text-white text-sm font-medium\"\n              type=\"button\"\n            >\n              Upgrade\n            </button>\n          </div>\n        </div>\n      );\n    }\n\n    if (s.status === \"active\" || s.status === \"paid\" || s.status === \"subscribed\") {\n      const nextDate = toDate(s.current_period_end);\n      const formatted = nextDate\n        ? new Intl.DateTimeFormat(undefined, { month: \"short\", day: \"numeric\", year: \"numeric\" }).format(nextDate)\n        : \"Next billing available\";\n\n      return (\n        <div className=\"flex flex-col gap-2\">\n          <div className=\"text-sm font-medium text-purple-100\">Subscribed</div>\n          <div className=\"text-xs text-purple-200\">Next billing: {formatted}</div>\n\n          <div className=\"pt-2\">\n            <button\n              onClick={() => router.push(\"/account\")}\n              className=\"block w-full cursor-pointer text-center px-2 py-1 rounded-md border hover:bg-purple-500 border-purple-600 text-purple-100 text-sm font-medium\"\n              type=\"button\"\n            >\n              Manage\n            </button>\n          </div>\n        </div>\n      );\n    }\n\n    // canceled or none\n    return (\n      <div className=\"flex flex-col gap-2\">\n        <div className=\"text-sm font-medium text-purple-100\">Not subscribed</div>\n        <div className=\"text-xs text-purple-200\">Start a 7-day trial or subscribe for full access.</div>\n\n        <div className=\"pt-2\">\n          <button\n            onClick={() => router.push(\"/account\")}\n            className=\"block w-full text-center px-2 py-1 rounded-md bg-gradient-to-r from-sky-500 to-indigo-500 text-white text-sm font-medium\"\n            type=\"button\"\n          >\n            Subscribe\n          </button>\n        </div>\n      </div>\n    );\n  };\n\n  return (\n    <>\n      {/* Mobile toggle button (visible only on small screens) — top-right */}\n      <button\n        aria-label={mobileOpen ? \"Close navigation\" : \"Open navigation\"}\n        onClick={() => setMobileOpen((s) => !s)}\n        className={`${mobileOpen ? \"\" : \"sm:hidden fixed top-4 right-4 z-50 bg-purple-800/90 text-white p-2 rounded-md shadow-lg focus:outline-none\"}`}\n      >\n        {mobileOpen ? \"\" : (\n          <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-5 w-5\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\"><path strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M4 6h16M4 12h16M4 18h16\" /></svg>\n        )}\n      </button>\n\n      {/* Overlay that closes mobile nav when clicked */}\n      <div\n        aria-hidden={!mobileOpen}\n        onClick={() => setMobileOpen(false)}\n        className={`sm:hidden fixed inset-0 bg-black/40 z-30 transition-opacity ${mobileOpen ? \"opacity-100 pointer-events-auto\" : \"opacity-0 pointer-events-none\"}`}\n      />\n\n      {/* Sidebar\n          - mobile (default): positioned on right (right-0), slides in/out from right\n          - desktop (sm+): positioned on left (sm:left-0) and always visible (sm:translate-x-0)\n      */}\n      <nav\n        className={`fixed top-0 h-full z-40 flex flex-col py-4 sm:py-6\n          bg-gradient-to-b from-purple-900/90 via-purple-800/90 to-indigo-900/90 backdrop-blur-md\n          transition-transform duration-300 ease-in-out transform\n          ${mobileClosedTransform} sm:translate-x-0\n          right-0 sm:left-0 sm:right-auto\n          w-44 sm:w-16 ${borderResponsive}`}\n        style={{ willChange: \"transform\" }}\n      >\n        {/* Logo row: keep logo and (mobile) site name inline when open */}\n        <div className=\"mb-4 sm:mb-8 w-full flex items-center justify-center sm:justify-center px-3\">\n          <Link href=\"/\" className=\"flex items-center gap-3 w-full\">\n            <div className=\"w-12 h-12 sm:w-16 sm:h-16 rounded-xl p-1.5 sm:p-2 flex items-center justify-center shadow-lg hover:shadow-xl transition-shadow\">\n              <img\n                src=\"/logo.png\"\n                alt=\"Logo\"\n                className=\"w-full h-full object-contain\"\n                onError={(e) => {\n                  const target = e.target as HTMLImageElement;\n                  target.style.display = \"none\";\n                  if (target.parentElement) {\n                    target.parentElement.innerHTML = '<div class=\"w-full h-full rounded-xl bg-gradient-to-br from-purple-500 via-purple-600 to-indigo-600 flex items-center justify-center text-white font-bold text-sm sm:text-xl\">AI</div>';\n                  }\n                }}\n              />\n            </div>\n\n            {/* Site name label visible on mobile when nav is open; aligns inline with logo */}\n            <span className={`${mobileOpen ? \"inline-block\" : \"hidden\"} sm:hidden text-white font-semibold text-lg ml-2 truncate`}>\n              Bunyad\n            </span>\n          </Link>\n        </div>\n\n        {/* Nav links - icons + labels aligned in a straight column (labels left-aligned) */}\n        <div className=\"flex flex-col gap-3 w-full px-2\">\n          <Link\n            href=\"/\"\n            className={`flex items-center gap-3 p-2 rounded-lg transition-all w-full\n              ${pathname === \"/\" ? \"bg-purple-600/50 text-white shadow-lg\" : \"text-purple-200 hover:bg-purple-700/30 hover:text-white\"}\n              ${mobileOpen ? \"justify-start pl-3\" : \"justify-center\"}`}\n            title=\"Dashboard\"\n          >\n            <svg className=\"w-5 h-5 sm:w-6 sm:h-6 flex-shrink-0\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z\" />\n            </svg>\n            <span className={`${mobileOpen ? \"inline-block\" : \"hidden\"} sm:hidden text-sm font-medium`}>Dashboard</span>\n          </Link>\n\n          {/* replaced Link with button using router.push for reliable navigation */}\n          <button\n            onClick={() => router.push(\"/subscribe\")}\n            className={`flex items-center gap-3 p-2 rounded-lg transition-all w-full\n              ${pathname === \"/subscribe\" ? \"bg-purple-600/50 text-white shadow-lg\" : \"text-purple-200 hover:bg-purple-700/30 hover:text-white\"}\n              ${mobileOpen ? \"justify-start pl-3\" : \"justify-center\"}`}\n            title=\"Plans\"\n            type=\"button\"\n          >\n            <svg className=\"w-5 h-5 sm:w-6 sm:h-6 flex-shrink-0\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" />\n            </svg>\n            <span className={`${mobileOpen ? \"inline-block\" : \"hidden\"} sm:hidden text-sm font-medium`}>Plans</span>\n          </button>\n\n          <Link\n            href=\"/about\"\n            className={`flex items-center gap-3 p-2 rounded-lg transition-all w-full\n              ${pathname === \"/about\" ? \"bg-purple-600/50 text-white shadow-lg\" : \"text-purple-200 hover:bg-purple-700/30 hover:text-white\"}\n              ${mobileOpen ? \"justify-start pl-3\" : \"justify-center\"}`}\n            title=\"Homepage\"\n          >\n            <svg className=\"w-5 h-5 sm:w-6 sm:h-6 flex-shrink-0\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" />\n            </svg>\n            <span className={`${mobileOpen ? \"inline-block\" : \"hidden\"} sm:hidden text-sm font-medium`}>Homepage</span>\n          </Link>\n        </div>\n\n        {/* Logout / avatar at bottom */}\n        <div className=\"mt-auto w-full px-2 pb-4\">\n          <div ref={dropdownRef} className=\"relative w-full\">\n            <button\n              onClick={() => setOpen((s) => !s)}\n              aria-haspopup=\"true\"\n              aria-expanded={open}\n              className={`w-full flex items-center gap-2 p-2 rounded-lg transition-all cursor-pointer\n                text-purple-200 hover:bg-purple-700/30 hover:text-white\n                ${mobileOpen ? \"justify-start pl-3\" : \"justify-center\"}`}\n              title={username}\n            >\n              <div className=\"w-8 h-8 sm:w-10 sm:h-10 rounded-full bg-gradient-to-br from-purple-500 to-indigo-600 flex items-center justify-center font-semibold text-white text-xs sm:text-sm shadow-lg flex-shrink-0\">\n                {userInitial}\n              </div>\n              <span className={`${mobileOpen ? \"inline-block\" : \"hidden\"} sm:hidden ml-1 text-sm font-medium`}>{username}</span>\n            </button>\n\n            {/* Dropdown opens left on mobile (nav on right), opens right on desktop (nav on left) */}\n            <div className={`absolute right-full mr-2 bottom-0 w-44 sm:w-48 bg-purple-800/95 backdrop-blur-md border border-purple-600/50 rounded-lg shadow-xl z-50 sm:left-full sm:ml-2 sm:right-auto ${open ? \"block\" : \"hidden\"}`}>\n              <div className=\"p-3\">\n                <div className=\"px-2 py-1.5 text-sm text-purple-100 font-semibold\">\n                  {username}\n                </div>\n\n                <div className=\"mt-2\">\n                  {renderSubscriptionRow()}\n                </div>\n\n                <div className=\"mt-3 border-t border-purple-700/50 pt-3\">\n                  <button\n                    onClick={handleLogout}\n                    className=\"w-full flex items-center gap-2 px-2 py-2 text-sm text-purple-200 hover:bg-purple-700/50 rounded cursor-pointer transition-colors\"\n                    aria-label=\"Logout\"\n                  >\n                    <LogOut size={16} />\n                    <span>Logout</span>\n                  </button>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </nav>\n    </>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 700, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Administrator/Desktop/my-flux-saas/app/subscribe/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useRouter, useSearchParams } from \"next/navigation\";\nimport { useState, useEffect, Suspense } from \"react\";\nimport Nav from \"../../components/Nav\";\n\nfunction SubscribeClientLogic() {\n  const router = useRouter();\n  const searchParams = useSearchParams(); \n\n  const [loading, setLoading] = useState(false);\n  const [message, setMessage] = useState<string | null>(null);\n  const [messageType, setMessageType] = useState<\"success\" | \"error\" | null>(null);\n\n  // subscription state pulled from /api/check-usage\n  const [checkingSub, setCheckingSub] = useState(true);\n  const [isSubscribed, setIsSubscribed] = useState<boolean | null>(null);\n  const [subLoading, setSubLoading] = useState(false);\n\n  const PRICE_ID = process.env.NEXT_PUBLIC_STRIPE_PRICE_PRO || \"price_1SSxP4KsBi3XJI5aSUGGrEKz\";\n\n  // handle Stripe success/cancel query params (rely on searchParams)\n  useEffect(() => {\n    const success = searchParams.get(\"success\");\n    const canceled = searchParams.get(\"canceled\");\n    const sessionId = searchParams.get(\"session_id\");\n\n    if (success === \"true\" && sessionId) {\n      setMessage(\"Payment successful! Verifying subscription...\");\n      setMessageType(\"success\");\n\n      const verifyAndRedirect = async () => {\n        let attempts = 0;\n        const maxAttempts = 10;\n\n        const checkInterval = setInterval(async () => {\n          attempts++;\n\n          try {\n            const res = await fetch(`/api/verify-session?session_id=${sessionId}`);\n            const data = await res.json();\n\n            if (data.verified && data.isSubscribed) {\n              clearInterval(checkInterval);\n              setMessage(\"Payment successful! Your subscription is now active.\");\n              setMessageType(\"success\");\n              // update local state to reflect subscription\n              setIsSubscribed(true);\n              // Redirect to homepage after short delay\n              setTimeout(() => {\n                router.push(\"/\");\n              }, 1000);\n            } else if (attempts >= maxAttempts) {\n              clearInterval(checkInterval);\n              setMessage(\"Payment successful! If you see this page again, please refresh.\");\n              setMessageType(\"success\");\n              setTimeout(() => {\n                router.push(\"/\");\n              }, 2000);\n            }\n          } catch (err) {\n            console.error(\"Error verifying session:\", err);\n            if (attempts >= maxAttempts) {\n              clearInterval(checkInterval);\n              setMessage(\"Payment successful! Redirecting...\");\n              setMessageType(\"success\");\n              setTimeout(() => {\n                router.push(\"/\");\n              }, 2000);\n            }\n          }\n        }, 500);\n      };\n\n      verifyAndRedirect();\n    } else if (canceled === \"true\") {\n      setMessage(\"Payment was canceled. You can try again anytime.\");\n      setMessageType(\"error\");\n    }\n  }, [searchParams, router]);\n\n  // Fetch subscription state on mount\n  useEffect(() => {\n    let mounted = true;\n    const fetchStatus = async () => {\n      if (mounted) setCheckingSub(true);\n      try {\n        const res = await fetch(\"/api/check-usage\");\n        if (!res.ok) {\n          // treat as not subscribed but show no crashing\n          const txt = await res.text();\n          console.warn(\"check-usage non-ok:\", txt);\n          if (mounted) setIsSubscribed(false);\n        } else {\n          const json = await res.json();\n          if (mounted) setIsSubscribed(Boolean(json?.isSubscribed));\n        }\n      } catch (err) {\n        console.error(\"Failed to fetch subscription status:\", err);\n        if (mounted) setIsSubscribed(false);\n      } finally {\n        if (mounted) setCheckingSub(false);\n      }\n    };\n\n    fetchStatus();\n    return () => {\n      mounted = false;\n    };\n  }, []);\n\n  // Opens Stripe checkout\n  const handleCheckout = async () => {\n    // Prevent starting checkout when already subscribed\n    if (isSubscribed) return;\n\n    // show loader first\n    setLoading(true);\n    setMessage(null);\n\n    // give browser one frame to paint loader before starting network/navigation\n    await new Promise((resolve) => requestAnimationFrame(() => resolve(null)));\n\n    try {\n      const res = await fetch(\"/api/checkout\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ priceId: PRICE_ID }),\n      });\n\n      const json = await res.json();\n\n      if (json?.url) {\n        // redirect to stripe checkout\n        window.location.href = json.url;\n      } else {\n        setMessage(\"Checkout failed: \" + (json?.error || \"Unknown error\"));\n        setMessageType(\"error\");\n        setLoading(false);\n      }\n    } catch (err) {\n      setMessage(\"Network error. Please try again.\");\n      setMessageType(\"error\");\n      setLoading(false);\n      console.error(err);\n    }\n  };\n\n  // Opens the billing portal (manage)\n  const openPortal = async () => {\n    setSubLoading(true);\n    // allow paint\n    await new Promise((resolve) => requestAnimationFrame(() => resolve(null)));\n\n    try {\n      const res = await fetch(\"/api/create-portal-session\", { method: \"POST\" });\n      const json = await res.json();\n      if (json?.url) {\n        window.location.href = json.url;\n      } else {\n        setMessage(\"Could not open billing portal.\");\n        setMessageType(\"error\");\n      }\n    } catch (e) {\n      console.error(e);\n      setMessage(\"Could not open billing portal.\");\n      setMessageType(\"error\");\n    } finally {\n      setSubLoading(false);\n    }\n  };\n  \n  // Return the main content JSX from your original component\n  return (\n    <>\n      <div className=\"max-w-3xl mx-auto p-6 py-12\">\n        <div className=\"text-center mb-8\">\n          <h2 className=\"text-4xl font-bold mb-2 text-purple-100\">Upgrade to Pro</h2>\n          <p className=\"text-purple-200 text-lg\">Unlock unlimited image transformations</p>\n        </div>\n\n        {message && (\n          <div\n            className={`mb-6 p-4 rounded-lg ${\n              messageType === \"success\"\n                ? \"bg-green-50 text-green-800 border border-green-200\"\n                : \"bg-red-50 text-red-800 border border-red-200\"\n            }`}\n          >\n            {message}\n          </div>\n        )}\n\n        <div className=\"bg-gray-800/40 backdrop-blur-sm border border-purple-700/30 rounded-2xl shadow-xl p-8\">\n          <div className=\"text-center mb-6\">\n            <div className=\"inline-block px-4 py-2 bg-gradient-to-r from-sky-500 to-indigo-500 text-white rounded-full text-sm font-semibold mb-4\">\n              PRO PLAN\n            </div>\n            <h3 className=\"text-3xl font-bold text-purple-100 mb-2\">Unlimited Access</h3>\n            <p className=\"text-purple-200\">Transform as many images as you want</p>\n          </div>\n\n          <div className=\"space-y-4 mb-8\">\n            <div className=\"flex items-center gap-3\">\n              <svg className=\"w-6 h-6 text-green-400\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M5 13l4 4L19 7\" />\n              </svg>\n              <span className=\"text-purple-200\">Unlimited image generations</span>\n            </div>\n            <div className=\"flex items-center gap-3\">\n              <svg className=\"w-6 h-6 text-green-400\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M5 13l4 4L19 7\" />\n              </svg>\n              <span className=\"text-purple-200\">Priority processing</span>\n            </div>\n            <div className=\"flex items-center gap-3\">\n              <svg className=\"w-6 h-6 text-green-400\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M5 13l4 4L19 7\" />\n              </svg>\n              <span className=\"text-purple-200\">No usage limits</span>\n            </div>\n            <div className=\"flex items-center gap-3\">\n              <svg className=\"w-6 h-6 text-green-400\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M5 13l4 4L19 7\" />\n              </svg>\n              <span className=\"text-purple-200\">Cancel anytime</span>\n            </div>\n          </div>\n\n          <div className=\"text-center mb-6\">\n            <div className=\"text-5xl font-bold text-purple-100 mb-2\">$9</div>\n            <div className=\"text-purple-200\">per month</div>\n          </div>\n\n          {/* If subscribed -> show disabled \"Subscribed\" button + Manage button\n              Otherwise show checkout Subscribe button */}\n          {isSubscribed ? (\n            <div className=\"space-y-3\">\n              <button\n                disabled\n                className=\"w-full px-6 py-4 bg-gray-600/30 text-white rounded-xl font-semibold text-lg shadow-inner cursor-not-allowed\"\n                aria-disabled\n              >\n                Subscribed\n              </button>\n\n              <button\n                onClick={openPortal}\n                disabled={subLoading}\n                className=\"w-full px-6 py-4 cursor-pointer bg-gray-700/60 bg-gradient-to-r from-sky-500 to-indigo-500 text-white rounded-xl font-semibold text-lg shadow-md hover:shadow-lg transform hover:scale-102 transition-all duration-150 disabled:opacity-50 mt-2\"\n              >\n                {subLoading ? \"Opening billing portal...\" : \"Manage Subscription\"}\n              </button>\n            </div>\n          ) : (\n            <div>\n              <button\n                onClick={handleCheckout}\n                disabled={loading}\n                className=\"w-full px-6 py-4 cursor-pointer bg-gradient-to-r from-sky-500 to-indigo-500 text-white rounded-xl font-semibold text-lg shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none\"\n              >\n                {loading ? \"Redirecting to checkout...\" : \"Subscribe Now\"}\n              </button>\n\n              <p className=\"text-center text-sm text-purple-300 mt-4\">\n                Secure payment powered by Stripe\n              </p>\n            </div>\n          )}\n        </div>\n      </div>\n\n      {/* Overlay shown while checking subscription (non-blocking) */}\n      {checkingSub && (\n        <div className=\"fixed inset-0 z-50 flex flex-col items-center justify-center bg-black/40 backdrop-blur-sm pointer-events-none\">\n          <div className=\"pointer-events-auto bg-white/10 rounded-lg p-6 flex items-center space-x-4\">\n            <div className=\"flex items-center space-x-2\">\n              <div className=\"w-3 h-3 bg-blue-400 rounded-full animate-bounce\" />\n              <div className=\"w-3 h-3 bg-blue-400 rounded-full animate-bounce\" style={{ animationDelay: \"0.15s\" }} />\n              <div className=\"w-3 h-3 bg-blue-400 rounded-full animate-bounce\" style={{ animationDelay: \"0.3s\" }} />\n            </div>\n            <div className=\"text-white\">Checking subscription…</div>\n          </div>\n        </div>\n      )}\n\n      {/* Overlay while performing checkout or opening portal (blocks interaction) */}\n      {(loading || subLoading) && (\n        <div className=\"fixed inset-0 z-60 flex items-center justify-center bg-black/50\">\n          <div className=\"flex flex-col items-center\">\n            <div className=\"w-12 h-12 border-4 border-gray-300 border-t-blue-400 rounded-full animate-spin mb-4\" />\n            <div className=\"text-white\">{loading ? \"Redirecting to checkout...\" : \"Opening billing portal...\"}</div>\n          </div>\n        </div>\n      )}\n    </>\n  );\n}\n\n// --- END: Inner Component (Protected Zone) ---\n\nfunction LoadingFallback() {\n  return (\n    <div className=\"max-w-3xl mx-auto p-6 py-12 text-center text-white\">\n      <div className=\"w-8 h-8 border-4 border-gray-300 border-t-blue-400 rounded-full animate-spin inline-block mr-2\" />\n      Loading page details...\n    </div>\n  );\n}\n\n\n// --- START: Main Page Component (The Suspense Boundary) ---\n\nexport default function SubscribePage() {\n  return (\n    // Outer div for the background/layout that doesn't need searchParams\n    <div className=\"min-h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 px-6 sm:pl-28 sm:pr-8 pt-20 sm:pt-24\">\n      <Nav /> \n      \n      {/* This is the required Suspense boundary. \n        It prevents the component using useSearchParams() (SubscribeClientLogic) \n        from running during the server-side build. \n      */}\n      <Suspense fallback={<LoadingFallback />}>\n        <SubscribeClientLogic />\n      </Suspense>\n    </div>\n  );\n}"],"names":[],"mappings":"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","debugId":null}}]
}