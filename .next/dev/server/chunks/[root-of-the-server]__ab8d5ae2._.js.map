{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 58, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/DELL/Desktop/my-flux-saas/lib/prisma.ts"],"sourcesContent":["import { PrismaClient } from \"@prisma/client\";\n\nconst globalForPrisma = globalThis as unknown as {\n  prisma: PrismaClient | undefined;\n};\n\nexport const prisma = globalForPrisma.prisma ?? new PrismaClient();\n\nif (process.env.NODE_ENV !== \"production\") globalForPrisma.prisma = prisma;\n\nexport default prisma;\n"],"names":[],"mappings":";;;;;;AAAA;;AAEA,MAAM,kBAAkB;AAIjB,MAAM,SAAS,gBAAgB,MAAM,IAAI,IAAI,6IAAY;AAEhE,wCAA2C,gBAAgB,MAAM,GAAG;uCAErD","debugId":null}},
    {"offset": {"line": 74, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/DELL/Desktop/my-flux-saas/app/api/login/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\";\nimport bcrypt from \"bcryptjs\";\nimport { prisma } from \"../../../lib/prisma\";\nimport { randomBytes } from \"crypto\";\n\nexport async function POST(req: NextRequest) {\n  try {\n    const body = await req.json();\n    const username = String(body?.username ?? \"\");\n    const password = String(body?.password ?? \"\");\n\n    if (!username || !password) {\n      return NextResponse.json(\n        { error: \"Username and password are required\" },\n        { status: 400 }\n      );\n    }\n\n    const user = await prisma.user.findFirst({\n      where: {\n        OR: [{ username }, { email: username }],\n      },\n    });\n\n    if (!user) {\n      return NextResponse.json(\n        { error: \"Invalid credentials\" },\n        { status: 401 }\n      );\n    }\n\n    const isValidPassword = await bcrypt.compare(password, user.password);\n    if (!isValidPassword) {\n      return NextResponse.json(\n        { error: \"Invalid credentials\" },\n        { status: 401 }\n      );\n    }\n\n    const token = randomBytes(32).toString(\"hex\");\n    const expiresAt = new Date();\n    expiresAt.setDate(expiresAt.getDate() + 7); // 7 days\n\n    await prisma.token.create({\n      data: {\n        token,\n        userId: user.id,\n        expiresAt,\n      },\n    });\n\n    const res = NextResponse.json({\n      success: true,\n      user: { id: user.id, email: user.email, username: user.username },\n    });\n\n    res.cookies.set({\n      name: \"flux_auth\",\n      value: token,\n      httpOnly: true,\n      path: \"/\",\n      sameSite: \"lax\",\n      secure: false,\n      maxAge: 60 * 60 * 24 * 7, // 7 days\n    });\n\n    return res;\n  } catch (err) {\n    console.error(\"Login error:\", err);\n    return NextResponse.json(\n      { error: \"Internal server error\" },\n      { status: 500 }\n    );\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;;;;;AAEO,eAAe,KAAK,GAAgB;IACzC,IAAI;QACF,MAAM,OAAO,MAAM,IAAI,IAAI;QAC3B,MAAM,WAAW,OAAO,MAAM,YAAY;QAC1C,MAAM,WAAW,OAAO,MAAM,YAAY;QAE1C,IAAI,CAAC,YAAY,CAAC,UAAU;YAC1B,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAqC,GAC9C;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,OAAO,MAAM,yHAAM,CAAC,IAAI,CAAC,SAAS,CAAC;YACvC,OAAO;gBACL,IAAI;oBAAC;wBAAE;oBAAS;oBAAG;wBAAE,OAAO;oBAAS;iBAAE;YACzC;QACF;QAEA,IAAI,CAAC,MAAM;YACT,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAsB,GAC/B;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,kBAAkB,MAAM,8IAAM,CAAC,OAAO,CAAC,UAAU,KAAK,QAAQ;QACpE,IAAI,CAAC,iBAAiB;YACpB,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAsB,GAC/B;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,QAAQ,IAAA,oHAAW,EAAC,IAAI,QAAQ,CAAC;QACvC,MAAM,YAAY,IAAI;QACtB,UAAU,OAAO,CAAC,UAAU,OAAO,KAAK,IAAI,SAAS;QAErD,MAAM,yHAAM,CAAC,KAAK,CAAC,MAAM,CAAC;YACxB,MAAM;gBACJ;gBACA,QAAQ,KAAK,EAAE;gBACf;YACF;QACF;QAEA,MAAM,MAAM,gJAAY,CAAC,IAAI,CAAC;YAC5B,SAAS;YACT,MAAM;gBAAE,IAAI,KAAK,EAAE;gBAAE,OAAO,KAAK,KAAK;gBAAE,UAAU,KAAK,QAAQ;YAAC;QAClE;QAEA,IAAI,OAAO,CAAC,GAAG,CAAC;YACd,MAAM;YACN,OAAO;YACP,UAAU;YACV,MAAM;YACN,UAAU;YACV,QAAQ;YACR,QAAQ,KAAK,KAAK,KAAK;QACzB;QAEA,OAAO;IACT,EAAE,OAAO,KAAK;QACZ,QAAQ,KAAK,CAAC,gBAAgB;QAC9B,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAAwB,GACjC;YAAE,QAAQ;QAAI;IAElB;AACF","debugId":null}}]
}